{% extends 'SharedTemplate/Base.html' %}
{% load static %}
<!DOCTYPE html>
<html dir="rtl">


<head>


</head>

<body>


{% block Contents %}
<div class="text-center row col-md-5 text-center">
<div class="row col">

        <form method="get" action="">
        <input class="form-control text-center" name="q" type="text" placeholder="لطفا کد سفارش را وارد کنید ">
            <button class="form-control" type="button" onclick="Export_Table_To_Excel('xlsx');">EXPORT</button>
            <br>
{#            <p id="xportxlsx" class="xport"><input type="button" value="Export to XLSX!" onclick="doit('xlsx');"></p>#}

{#            <button class="form-control" type="button" onclick="doit('xlsx')">Export </button>#}


        </form>
    <br>
    <br>
<table id="TableBarcode">
      <tr class="header">
{#    <th style="width:20%;">کد سفارش</th>#}
{#    <th style="width:40%;">تاریخ</th>#}
{#    <th style="width:40%;">ساعت</th>#}
    <th style="width:40%;">Tracing Code</th>
  </tr>
        {% for code in object_list %}

        <tr >

{#              <td > {{ code.order.filter.get }}</td>#}
{#              <td>{{ code.Date  }}</td>#}
{#              <td>{{ code.time }}</td>#}
              <td>{{ code.Tracebility_code}}</td>

          </tr>

        </a>
    {% endfor %}


</table>



</div>
    <script type="text/javascript">
{#function ExportToExcel(TableBarcode){#}
{#       var htmltable= document.getElementById('TableBarcode');#}
{#       var html = htmltable.outerHTML;#}
{#       window.open('data:application/vnd.ms-excel,' + encodeURIComponent(html));#}
{#    }#}


<script type="text/javascript" src="//unpkg.com/xlsx/dist/shim.min.js"></script>
<script type="text/javascript" src="//cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>

<script type="text/javascript" src="//unpkg.com/blob.js@1.0.1/Blob.js"></script>
<script type="text/javascript" src="//unpkg.com/file-saver@1.3.3/FileSaver.js"></script>


<script>
function Export_Table_To_Excel(type, fn, dl) {
	var elt = document.getElementById('TableBarcode');
	var wb = XLSX.utils.table_to_book(elt, {sheet:"Sheet JS"});
	return dl ?
		XLSX.write(wb, {bookType:type, bookSST:true, type: 'base64'}) :
		XLSX.writeFile(wb, fn || ( 'TracingCode.' + (type || 'xlsx')));
}
</script>


{##}
{#	<p id="xportxlsx" class="xport"><input type="submit" value="Export to XLSX!" onclick="doit('xlsx');"></p>#}


<script type="text/javascript">
</script>


</script>



</div>

{% endblock %}


</body>



</html>












